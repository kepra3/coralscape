chi <- chisq.test(tab.stand)
fish <- fisher.test(table(metadata$Taxa, metadata$Depth), simulate.p.value = TRUE)
corrplot(chi$residuals, is.corr = FALSE, col.lim = c(-11, 11))
chi$expected
chi$observed
ggplot(metadata, aes(Depth, fill = Taxa)) +
geom_bar(position = "fill") +
scale_fill_manual(values = colours) +
scale_y_continuous(label = scales::percent) +
theme(axis.text = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14),
axis.title = element_text(size = 14),
plot.title = element_text(size = 18, face = 'bold')) +
ylab("Proportion") +
theme_classic()
ggplot(metadata, aes(Taxa, fill = Depth)) +
geom_bar(position = "fill") +
scale_fill_manual(values = blues9[c(3, 6, 9)]) +
scale_y_continuous(label = scales::percent) +
theme(axis.text = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14),
axis.title = element_text(size = 14),
plot.title = element_text(size = 18, face = 'bold')) +
ylab("Proportion") +
theme_classic()
# Depth and location ####
x <- as.data.frame(table(metadata$Taxa, metadata$Site))
str(x)
x$Freq <- as.numeric(x$Freq)
x$bin[x$Freq == 0] <- NA
x$bin[x$Freq >= 3 & x$Freq < 10] <- 4
x$bin[x$Freq >= 10 & x$Freq < 20] <- 5
x$bin[x$Freq >= 20 & x$Freq < 30] <- 6
x$bin[x$Freq >= 30 & x$Freq < 40] <- 7
x$bin[x$Freq >= 40 & x$Freq < 50] <- 8
x$bin[x$Freq >= 50] <- 9
x$Freq[x$Freq == 0] <- NA
ggplot(data = x, aes(Var1, 1, fill = Var1)) + geom_point(size = x$bin, shape = 21) +
scale_fill_manual(values = colours) +
geom_text(aes(Var1, 1, label = Freq), size = 2, colour = "black", face = "bold") +
facet_wrap(~Var2, nrow = 4, ncol = 4) + theme_classic() +
scale_x_discrete(position = "top") +
theme(axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.line.y = element_blank(),
strip.placement = "outside",
strip.text = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
panel.border = element_rect(colour = "grey", fill = NA),
panel.grid.major.x = element_line(),
legend.position = "none")
# Separate by Depths ####
metadata20 <- metadata[metadata$Depth == "20",]
metadata10 <- metadata[metadata$Depth == "10-12" &
(metadata$Taxa == "AA2" |
metadata$Taxa == "AH1" |
metadata$Taxa == "AH3" |
metadata$Taxa == "AL2"),]
metadata5 <- metadata[metadata$Depth == "5",]
# *** Linear Models ***  ####
# Phenotypic differences ####
## Colony rugosity ####
k_boxplot(metadata5, metadata5$Taxa, metadata5$colony_rugosity, "Colony rugosity", colours[2:5], facet = "All")
k_boxplot(metadata10, metadata10$Taxa, metadata10$colony_rugosity, "Colony rugosity", colours[c(2,3,5,7)], facet = "All")
k_boxplot(metadata20, metadata20$Taxa, metadata20$colony_rugosity, "Colony rugosity", colours[c(1:3,6,7)], facet = "All")
k_boxplot(metadata, metadata$Taxa, metadata$colony_rugosity, "Colony rugosity", colours, facet = "Depth")
k_boxplot <- function(df, categorical, continuous, lab, colours, facet="No") {
categorical <- droplevels(categorical)
present_taxa <- levels(categorical)
sample.sizes <- NA
for (i in 1:length(present_taxa)) {
sample.sizes[i] <- length(categorical[categorical == present_taxa[i]])
}
if (facet == "All") {
p <- ggplot(df, aes(x = categorical, y = continuous, color = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 16) +
#scale_x_discrete(labels = label) +
scale_color_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth + Loc, nrow = 1)
} else if (facet == "Depth") {
p <- ggplot(df, aes(x = categorical, y = continuous, color = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 16) +
#scale_x_discrete(labels = label) +
scale_color_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth)
} else if (facet == "Loc") {
p <- ggplot(df, aes(x = categorical, y = continuous, color = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 16) +
#scale_x_discrete(labels = label) +
scale_color_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Loc)
} else {
label = paste0(present_taxa, "\n n = ", sample.sizes)
p <- ggplot(df, aes(x = categorical, y = continuous, colour = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 16) +
scale_x_discrete(labels = label) +
scale_color_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') }
return(p)
}
k_boxplot(metadata, metadata$Taxa, metadata$colony_rugosity, "Colony rugosity", colours, facet = "Depth")
k_boxplot <- function(df, categorical, continuous, lab, colours, facet="No") {
categorical <- droplevels(categorical)
present_taxa <- levels(categorical)
sample.sizes <- NA
for (i in 1:length(present_taxa)) {
sample.sizes[i] <- length(categorical[categorical == present_taxa[i]])
}
if (facet == "All") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 19) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth + Loc, nrow = 1)
} else if (facet == "Depth") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 19) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth)
} else if (facet == "Loc") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 19) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Loc)
} else {
label = paste0(present_taxa, "\n n = ", sample.sizes)
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 19) +
scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') }
return(p)
}
k_boxplot(metadata, metadata$Taxa, metadata$colony_rugosity, "Colony rugosity", colours, facet = "Depth")
k_boxplot <- function(df, categorical, continuous, lab, colours, facet="No") {
categorical <- droplevels(categorical)
present_taxa <- levels(categorical)
sample.sizes <- NA
for (i in 1:length(present_taxa)) {
sample.sizes[i] <- length(categorical[categorical == present_taxa[i]])
}
if (facet == "All") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth + Loc, nrow = 1)
} else if (facet == "Depth") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth)
} else if (facet == "Loc") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Loc)
} else {
label = paste0(present_taxa, "\n n = ", sample.sizes)
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 3, shape = 21) +
scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') }
return(p)
}
k_boxplot(metadata, metadata$Taxa, metadata$colony_rugosity, "Colony rugosity", colours, facet = "Depth")
if (facet == "All") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth + Loc, nrow = 1)
} else if (facet == "Depth") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth)
} else if (facet == "Loc") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Loc)
} else {
label = paste0(present_taxa, "\n n = ", sample.sizes)
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') }
k_boxplot <- function(df, categorical, continuous, lab, colours, facet="No") {
categorical <- droplevels(categorical)
present_taxa <- levels(categorical)
sample.sizes <- NA
for (i in 1:length(present_taxa)) {
sample.sizes[i] <- length(categorical[categorical == present_taxa[i]])
}
if (facet == "All") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth + Loc, nrow = 1)
} else if (facet == "Depth") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth)
} else if (facet == "Loc") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Loc)
} else {
label = paste0(present_taxa, "\n n = ", sample.sizes)
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 3, shape = 21) +
scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') }
return(p)
}
k_boxplot(metadata, metadata$Taxa, metadata$colony_rugosity, "Colony rugosity", colours, facet = "Depth")
k_boxplot <- function(df, categorical, continuous, lab, colours, facet="No") {
categorical <- droplevels(categorical)
present_taxa <- levels(categorical)
sample.sizes <- NA
for (i in 1:length(present_taxa)) {
sample.sizes[i] <- length(categorical[categorical == present_taxa[i]])
}
if (facet == "All") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 2, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth + Loc, nrow = 1)
} else if (facet == "Depth") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 2, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth)
} else if (facet == "Loc") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 2, shape = 21) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Loc)
} else {
label = paste0(present_taxa, "\n n = ", sample.sizes)
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot(fill = NA) +
geom_point(size = 2, shape = 21) +
scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') }
return(p)
}
k_boxplot(metadata, metadata$Taxa, metadata$colony_rugosity, "Colony rugosity", colours, facet = "Depth")
k_boxplot <- function(df, categorical, continuous, lab, colours, facet="No") {
categorical <- droplevels(categorical)
present_taxa <- levels(categorical)
sample.sizes <- NA
for (i in 1:length(present_taxa)) {
sample.sizes[i] <- length(categorical[categorical == present_taxa[i]])
}
if (facet == "All") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 2, shape = 16) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth + Loc, nrow = 1)
} else if (facet == "Depth") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 2, shape = 16) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Depth)
} else if (facet == "Loc") {
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 2, shape = 16) +
#scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') +
facet_wrap(~ Loc)
} else {
label = paste0(present_taxa, "\n n = ", sample.sizes)
p <- ggplot(df, aes(x = categorical, y = continuous, fill = categorical)) +
geom_boxplot() +
geom_point(size = 2, shape = 16) +
scale_x_discrete(labels = label) +
scale_fill_manual(name = "Taxa", values = colours,
label = present_taxa) +
theme_classic(base_size = 12) +
ylab(lab) +
xlab('Taxa') }
return(p)
}
k_boxplot(metadata, metadata$Taxa, metadata$colony_rugosity, "Colony rugosity", colours, facet = "Depth")
source("~/git/coralscape/scripts/microniche_stats_21-6-22.R", echo=TRUE)
# Microhabitat differences ####
## Ground elevation ####
k_boxplot(metadata5, metadata5$Taxa, metadata5$ground_elevation_corr, "Ground Elevation corr", colours[2:5], facet = "All")
ggsave("new_plots/ground_elevation_corr_5m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata10, metadata10$Taxa, metadata10$ground_elevation_corr, "Ground Elevation corr", colours[c(2,3,5,7)], facet = "All")
ggsave("new_plots/ground_elevation_corr_10m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata20, metadata20$Taxa, metadata20$ground_elevation_corr, "Ground Elevation corr", colours[c(1:3,6,7)], facet = "All")
ggsave("new_plots/ground_elevation_corr_20m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata, metadata$Taxa, metadata$ground_elevation_corr, "Ground Elevation corr", colours, facet = "Depth")
ggsave("new_plots/ground_elevation_corr_all.pdf", height = 10, width = 20, units = "cm")
# Random effect of Location
lmer.ground_elevation20 <- lmer(ground_elevation_corr ~ Taxa + (1|Loc), data = metadata20)
summary(lmer.ground_elevation20)
plot(lmer.ground_elevation20)
emmeans(lmer.ground_elevation20, list(pairwise ~ Taxa), adjust = "tukey")
## Environment rugosity ####
k_boxplot(metadata5, metadata5$Taxa, metadata5$environment_rugosity_sqrt, "Square-root of Environment Rugosity", colours[2:5], facet = "All")
ggsave("new_plots/environment_rugosity_sqrt_5m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata10, metadata10$Taxa, metadata10$environment_rugosity_sqrt, "Square-root of Environment Rugosity", colours[c(2,3,5,7)], facet = "All")
ggsave("new_plots/environment_rugosity_sqrt_10m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata20, metadata20$Taxa, metadata20$environment_rugosity_sqrt, "Square-root of Environment Rugosity", colours[c(1:3,6,7)], facet = "All")
ggsave("new_plots/environment_rugosity_sqrt_20m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata, metadata$Taxa, metadata$environment_rugosity_sqrt, "Square-root of Environment Rugosity", colours, facet = "Depth")
ggsave("new_plots/environment_rugosity_sqrt_all.pdf", height = 10, width = 20, units = "cm")
## Outcrop proportion ####
k_boxplot(metadata5, metadata5$Taxa, metadata5$outcrop_prop, "Outcrop proportion", colours[2:5], facet = "All")
ggsave("new_plots/outcrop_prop_5m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata10, metadata10$Taxa, metadata10$outcrop_prop, "Outcrop proportion", colours[c(2,3,5,7)], facet = "All")
ggsave("new_plots/outcrop_prop_10m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata20, metadata20$Taxa, metadata20$outcrop_prop, "Outcrop proportion", colours[c(1:3,6,7)], facet = "All")
ggsave("new_plots/outcrop_prop_20m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata, metadata$Taxa, metadata$outcrop_prop, "Outcrop proportion", colours, facet = "Depth")
ggsave("new_plots/outcrop_prop_all.pdf", height = 10, width = 20, units = "cm")
## Overhang proportion ####
# TODO: USE BETA REGRESSION THAT ACCOUNTS FOR ZERO INFLATED DATA ##
k_boxplot(metadata5, metadata5$Taxa, metadata5$overhang_prop_2, "Overhang proportion", colours[2:5], facet = "All")
ggsave("new_plots/overhang_prop_2_5m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata10, metadata10$Taxa, metadata10$overhang_prop_2, "Overhang proportion", colours[c(2,3,5,7)], facet = "All")
ggsave("new_plots/overhang_prop_2_10m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata20, metadata20$Taxa, metadata20$overhang_prop_2, "Overhang proportion", colours[c(1:3,6,7)], facet = "All")
ggsave("new_plots/overhang_prop_2_20m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata, metadata$Taxa, metadata$overhang_prop_2, "Overhang proportion", colours, facet = "Depth")
ggsave("new_plots/overhang_prop_2_all.pdf", height = 10, width = 20, units = "cm")
## Z - local depth... ####
k_boxplot(metadata5, metadata5$Taxa, metadata5$z_scale, "Local height", colours[2:5], facet = "All")
ggsave("new_plots/z_scale_5m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata10, metadata10$Taxa, metadata10$z_scale, "Local height", colours[c(2,3,5,7)], facet = "All")
ggsave("new_plots/z_scale_10m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata20, metadata20$Taxa, metadata20$z_scale, "Local height", colours[c(1:3,6,7)], facet = "All")
ggsave("new_plots/z_scale_20m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata, metadata$Taxa, metadata$z_scale, "Local height", colours, facet = "Depth")
ggsave("new_plots/z_scale_all.pdf", height = 10, width = 20, units = "cm")
# Microhabitat differences ####
## Ground elevation ####
k_boxplot(metadata5, metadata5$Taxa, metadata5$ground_elevation_corr, "Substrate angle", colours[2:5], facet = "All")
ggsave("new_plots/ground_elevation_corr_5m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata10, metadata10$Taxa, metadata10$ground_elevation_corr, "Substrate angle", colours[c(2,3,5,7)], facet = "All")
ggsave("new_plots/ground_elevation_corr_10m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata20, metadata20$Taxa, metadata20$ground_elevation_corr, "Substrate angle", colours[c(1:3,6,7)], facet = "All")
ggsave("new_plots/ground_elevation_corr_20m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata, metadata$Taxa, metadata$ground_elevation_corr, "Substrate angle", colours, facet = "Depth")
ggsave("new_plots/ground_elevation_corr_all.pdf", height = 10, width = 20, units = "cm")
## Environment rugosity ####
k_boxplot(metadata5, metadata5$Taxa, metadata5$environment_rugosity_sqrt, "Square-root of environment rugosity", colours[2:5], facet = "All")
ggsave("new_plots/environment_rugosity_sqrt_5m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata10, metadata10$Taxa, metadata10$environment_rugosity_sqrt, "Square-root of environment rugosity", colours[c(2,3,5,7)], facet = "All")
ggsave("new_plots/environment_rugosity_sqrt_10m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata20, metadata20$Taxa, metadata20$environment_rugosity_sqrt, "Square-root of environment rugosity", colours[c(1:3,6,7)], facet = "All")
ggsave("new_plots/environment_rugosity_sqrt_20m.pdf", height = 10, width = 20, units = "cm")
k_boxplot(metadata, metadata$Taxa, metadata$environment_rugosity_sqrt, "Square-root of environment rugosity", colours, facet = "Depth")
ggsave("new_plots/environment_rugosity_sqrt_all.pdf", height = 10, width = 20, units = "cm")
